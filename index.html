<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MH SPORTS - Advanced</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #050a14; color: white; font-family: sans-serif; }
        .tab-btn { padding: 10px 15px; font-weight: bold; border-radius: 8px; transition: 0.3s; cursor: pointer; font-size: 12px; }
        .tab-btn.active { background-color: #2563eb; color: white; }
        .tab-btn.inactive { background-color: #1e293b; color: #94a3b8; }
        .match-card { background: #0f172a; border: 1px solid #1e293b; border-radius: 15px; margin-bottom: 15px; padding: 20px; }
        .live-pulse { width: 8px; height: 8px; background: #ef4444; border-radius: 50%; display: inline-block; margin-right: 5px; animation: pulse 1s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.3; } 100% { opacity: 1; } }
    </style>
</head>
<body>
    <div class="text-center py-6 bg-[#0f172a] border-b border-gray-800 sticky top-0 z-50">
        <h1 class="text-3xl font-black text-blue-500 uppercase tracking-tighter">MH SPORTS</h1>
        <div class="flex justify-center space-x-2 mt-4 px-2">
            <div id="tab-live" onclick="showCategory('live')" class="tab-btn active">LIVE</div>
            <div id="tab-upcoming" onclick="showCategory('upcoming')" class="tab-btn inactive">UPCOMING</div>
            <div id="tab-recent" onclick="showCategory('recent')" class="tab-btn inactive">RECENT</div>
        </div>
    </div>

    <div class="container mx-auto p-4 max-w-xl" id="match-container">
        <div class="text-center py-20 text-gray-500">ডেটা লোড হচ্ছে...</div>
    </div>

    <script>
        let allMatches = [];
        const api = "https://api.cricfys.one/api/v2/live_matches";
        const proxy = "https://corsproxy.io/?";

        async function loadMatches() {
            try {
                const res = await fetch(proxy + encodeURIComponent(api));
                const json = await res.json();
                allMatches = json.data || [];
                showCategory('live'); 
            } catch (e) {
                document.getElementById('match-container').innerHTML = "সার্ভার ব্যস্ত, আবার চেষ্টা করুন।";
            }
        }

        function showCategory(type) {
            // বাটন ডিজাইন আপডেট
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.replace('active', 'inactive'));
            document.getElementById(`tab-${type}`).classList.replace('inactive', 'active');

            const container = document.getElementById('match-container');
            container.innerHTML = "";

            // CRICFy API অনুযায়ী ফিল্টার লজিক
            let filtered = [];
            if (type === 'live') {
                filtered = allMatches.filter(m => m.is_live == "1");
            } else if (type === 'upcoming') {
                // যে ম্যাচগুলো লাইভ না (0) এবং রিসেন্ট না, সেগুলোই আপকামিং
                filtered = allMatches.filter(m => m.is_live == "0");
            } else {
                // রিসেন্ট ম্যাচ সাধারণত ২ বা অন্য স্ট্যাটাসে থাকে
                filtered = allMatches.filter(m => m.is_live == "2");
            }

            if (filtered.length === 0) {
                container.innerHTML = `<p class="text-center py-20 text-gray-500 font-bold uppercase">No ${type} matches available!</p>`;
                return;
            }

            filtered.forEach(m => {
                container.innerHTML += `
                <div class="match-card">
                    <div class="flex justify-between text-[10px] text-gray-500 mb-4 font-bold uppercase">
                        <span>${m.title}</span>
                        ${m.is_live == "1" ? '<span class="text-red-500 flex items-center"><i class="live-pulse"></i> LIVE</span>' : '<span>' + (m.date || 'UPCOMING') + '</span>'}
                    </div>
                    <div class="flex items-center justify-between text-center mb-6">
                        <div class="w-5/12">
                            <img src="${m.team_a_img}" class="w-14 h-14 mx-auto mb-2 rounded-full border-2 border-gray-800 p-1">
                            <p class="text-xs font-bold">${m.team_a}</p>
                        </div>
                        <div class="text-lg font-black italic text-gray-700">VS</div>
                        <div class="w-5/12">
                            <img src="${m.team_b_img}" class="w-14 h-14 mx-auto mb-2 rounded-full border-2 border-gray-800 p-1">
                            <p class="text-xs font-bold">${m.team_b}</p>
                        </div>
                    </div>
                    <a href="player.html?url=${btoa(m.stream_url)}" class="block w-full bg-blue-600 text-center py-3 rounded-xl font-bold text-sm shadow-lg hover:bg-blue-700 transition">WATCH NOW</a>
                </div>`;
            });
        }

        loadMatches();
        setInterval(loadMatches, 60000); // প্রতি ১ মিনিটে অটো রিফ্রেশ
    </script>
</body>
</html>
